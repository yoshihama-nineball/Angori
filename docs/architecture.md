# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚¬ã‚¤ãƒ‰

Angoriã®æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ»è¨­è¨ˆæ€æƒ³ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã®è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã™ã€‚

## ğŸ› ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Client Layer                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Next.js 15 Frontend (React 19 + TypeScript)               â”‚
â”‚  â”œâ”€ Material-UI v6 (Gorilla Theme)                         â”‚
â”‚  â”œâ”€ D3.js v7 (Data Visualization)                          â”‚
â”‚  â”œâ”€ Zustand (State Management)                             â”‚
â”‚  â””â”€ React Hook Form + Zod (Form & Validation)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    API Layer                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Rails 7.1.5 API (Ruby 3.2.3)                            â”‚
â”‚  â”œâ”€ Devise + JWT Authentication                            â”‚
â”‚  â”œâ”€ RESTful API Endpoints                                  â”‚
â”‚  â””â”€ OpenAI API Integration                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Data Layer                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL 16+ (Primary Database)                         â”‚
â”‚  Redis (Session & Cache)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“é¸å®šç†ç”±

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

**Next.js 15 + React 19**
- âœ… App Router ã«ã‚ˆã‚‹ç›´æ„Ÿçš„ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- âœ… Turbopack ã«ã‚ˆã‚‹é«˜é€Ÿé–‹ç™ºä½“é¨“
- âœ… Server Components/Actions ã§ã®ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯é–‹ç™º
- âœ… TypeScript ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®å„ªã‚ŒãŸé–‹ç™ºä½“é¨“

**Material-UI v6**
- âœ… Googleã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ æº–æ‹ 
- âœ… ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ
- âœ… ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒï¼ˆã‚´ãƒªãƒ©ãƒ†ãƒ¼ãƒï¼‰ã®æŸ”è»Ÿæ€§
- âœ… React 19 å¯¾å¿œ

**D3.js v7**
- âœ… ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã®ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰
- âœ… ã‚¢ãƒ³ã‚¬ãƒ¼ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã«ç‰¹åŒ–ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—å®Ÿè£…
- âœ… SVG/Canvas ã«ã‚ˆã‚‹é«˜æ€§èƒ½ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

**Ruby on Rails 7.1.5**
- âœ… APIé–‹ç™ºã«ãŠã‘ã‚‹è±Šå¯Œãªå®Ÿç¸¾
- âœ… è¦ç´„ã«ã‚ˆã‚‹é–‹ç™ºé€Ÿåº¦å‘ä¸Š
- âœ… ActiveRecord ã«ã‚ˆã‚‹å„ªã‚ŒãŸORM
- âœ… Gem ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã®å……å®Ÿ

**PostgreSQL 16+**
- âœ… JSONå‹ã«ã‚ˆã‚‹ãƒ•ãƒ¬ã‚­ã‚·ãƒ–ãƒ«ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ 
- âœ… é«˜åº¦ãªã‚¯ã‚¨ãƒªæ©Ÿèƒ½ï¼ˆåˆ†æç”¨é€”ï¼‰
- âœ… æœ¬æ ¼é‹ç”¨ã§ã®ä¿¡é ¼æ€§

**JWTèªè¨¼**
- âœ… ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹èªè¨¼ã«ã‚ˆã‚‹ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
- âœ… SPA ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã®è¦ªå’Œæ€§
- âœ… ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå¯¾å¿œã®å°†æ¥æ€§

## ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
Angori/ (ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)
â”œâ”€â”€ ğŸ³ docker-compose.yml        # Dockerçµ±åˆç’°å¢ƒè¨­å®š
â”œâ”€â”€ ğŸ³ .env.docker              # Dockerç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ ğŸ³ docker/                  # Dockerç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ setup.sh            # è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚       â””â”€â”€ cleanup.sh          # ç’°å¢ƒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
â”‚
â”œâ”€â”€ .github/                   # GitHubè¨­å®šãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”‚   â”œâ”€â”€ ISSUE_TEMPLATE/        # Issueãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â””â”€â”€ workflows/             # CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”‚       â”œâ”€â”€ frontend.yml       # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰CI/CD
â”‚       â””â”€â”€ backend.yml        # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰CI/CD
â”‚
â”œâ”€â”€ docs/                      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­è¨ˆãƒ»ä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ DEVELOPMENT.md         # é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ ARCHITECTURE.md        # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â”œâ”€â”€ DEPLOYMENT.md          # ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ CONTRIBUTING.md        # ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ ProjectManagement/     # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
â”‚   â””â”€â”€ DesignDocuments/       # è¨­è¨ˆæ›¸
â”‚
â”œâ”€â”€ frontend/                  # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ ğŸ³ Dockerfile           # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨ã‚³ãƒ³ãƒ†ãƒŠ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/               # App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/        # èªè¨¼é–¢é€£ãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â”‚   â”œâ”€â”€ actions/       # Server Actions
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts        # èªè¨¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ anger-log.ts   # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/     # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â”œâ”€â”€ records/       # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°è¨˜éŒ²ãƒ»ä¸€è¦§
â”‚   â”‚   â”‚   â”œâ”€â”€ calendar/      # æ„Ÿæƒ…è¨˜éŒ²ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ analysis/      # å‚¾å‘åˆ†æãƒ»ãƒãƒ–ãƒ«ãƒãƒƒãƒ—
â”‚   â”‚   â”‚   â”œâ”€â”€ consultation/  # AIç›¸è«‡å®¤
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/        # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/        # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé–¢é€£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FooterNav/ # ã‚¹ãƒãƒ›4ã‚¿ãƒ–ãƒŠãƒ“
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Sidebar/   # PCç”¨ã‚µã‚¤ãƒ‰ãƒãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/            # åŸºæœ¬UIè¦ç´ 
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Card/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Modal/
â”‚   â”‚   â”‚   â”œâ”€â”€ providers/     # Context Providers
â”‚   â”‚   â”‚   â””â”€â”€ feedback/      # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ features/          # æ©Ÿèƒ½åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # èªè¨¼æ©Ÿèƒ½
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ components/    # LoginForm, RegisterFormç­‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/         # useAuthï¼ˆèªè¨¼çŠ¶æ…‹ç®¡ç†ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”‚   â”œâ”€â”€ anger-logs/    # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°æ©Ÿèƒ½
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ components/    # LogItem, LogFormç­‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/         # useAngerLogç­‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”‚   â”œâ”€â”€ consultation/  # AIç›¸è«‡æ©Ÿèƒ½
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ components/    # ChatInterface, AdviceCardç­‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ hooks/         # useAIConsultationç­‰
â”‚   â”‚   â”‚   â”œâ”€â”€ visualization/ # å‚¾å‘åˆ†æãƒ»D3.js
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ components/    # BubbleMap, TrendChartç­‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/         # useAngerAnalysisç­‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ d3-utils/      # D3.js ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â”‚   â”‚   â””â”€â”€ calendar/      # æ„Ÿæƒ…è¨˜éŒ²ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
â”‚   â”‚   â”‚       â”œâ”€â”€ components/    # EmotionCalendarç­‰
â”‚   â”‚   â”‚       â””â”€â”€ hooks/         # useEmotionCalendarç­‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ lib/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»è¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ api/           # APIé–¢æ•°ç¾¤
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ angerLogs.ts   # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°API
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts        # èªè¨¼API
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ consultation.ts # AIç›¸è«‡API
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ analytics.ts   # åˆ†æAPI
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts         # Rails API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆbaseï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # JWTèªè¨¼ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dal.ts         # verifySessionç­‰ï¼ˆServer Actionsç”¨ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ session.ts     # createSession, deleteSession
â”‚   â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ store/             # ZustandçŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ authStore.ts       # èªè¨¼çŠ¶æ…‹
â”‚   â”‚   â”‚   â”œâ”€â”€ angerLogStore.ts   # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°çŠ¶æ…‹
â”‚   â”‚   â”‚   â””â”€â”€ uiStore.ts         # UIçŠ¶æ…‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ types/             # TypeScriptå‹å®šç¾©
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts             # APIé–¢é€£å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ anger.ts           # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°é–¢é€£å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ visualization.ts   # D3.jsãƒ»åˆ†æé–¢é€£å‹
â”‚   â”‚   â”‚   â””â”€â”€ user.ts            # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ theme/             # MUIã‚´ãƒªãƒ©ãƒ†ãƒ¼ãƒ
â”‚   â”‚       â””â”€â”€ gorilla.ts         # ã‚´ãƒªãƒ©ãƒ†ãƒ¼ãƒè¨­å®š
â”‚   â”‚
â”‚   â”œâ”€â”€ .vscode/               # VS Codeè¨­å®š
â”‚   â”œâ”€â”€ __tests__/             # çµ±åˆãƒ†ã‚¹ãƒˆãƒ»E2Eãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ __mocks__/             # ãƒ¢ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ .env.local
â”‚   â”œâ”€â”€ .eslintrc.json         # ESLintè¨­å®š
â”‚   â”œâ”€â”€ .prettierrc            # Prettierè¨­å®š
â”‚   â”œâ”€â”€ jest.config.js         # Jestè¨­å®š
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ backend/                   # Rails API
â”‚   â”œâ”€â”€ ğŸ³ Dockerfile           # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ã‚³ãƒ³ãƒ†ãƒŠ
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ controllers/       # APIã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ api/v1/        # API v1
â”‚   â”‚   â”‚       â”œâ”€â”€ auth/          # èªè¨¼é–¢é€£
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ sessions_controller.rb  # ãƒ­ã‚°ã‚¤ãƒ³/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ registrations_controller.rb  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
â”‚   â”‚   â”‚       â”œâ”€â”€ anger_logs_controller.rb   # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°CRUD
â”‚   â”‚   â”‚       â”œâ”€â”€ consultations_controller.rb # AIç›¸è«‡
â”‚   â”‚   â”‚       â””â”€â”€ analytics_controller.rb    # åˆ†æãƒ‡ãƒ¼ã‚¿
â”‚   â”‚   â”œâ”€â”€ models/            # ActiveRecordãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ user.rb            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«ï¼ˆèªè¨¼ä»˜ãï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ anger_log.rb       # ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ trigger_word.rb    # ãƒˆãƒªã‚¬ãƒ¼ãƒ¯ãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â””â”€â”€ ai_advice.rb       # AI ã‚¢ãƒ‰ãƒã‚¤ã‚¹å±¥æ­´
â”‚   â”‚   â”œâ”€â”€ services/          # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ openai_service.rb      # OpenAI APIçµ±åˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ anger_analysis_service.rb  # æ„Ÿæƒ…åˆ†æ
â”‚   â”‚   â”‚   â””â”€â”€ advice_generation_service.rb  # ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ serializers/       # API ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ•´å½¢
â”‚   â”‚       â”œâ”€â”€ user_serializer.rb
â”‚   â”‚       â”œâ”€â”€ anger_log_serializer.rb
â”‚   â”‚       â””â”€â”€ analysis_serializer.rb
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                # Railsè¨­å®š
â”‚   â”‚   â”œâ”€â”€ initializers/      # åˆæœŸåŒ–è¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ cors.rb            # CORSè¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ devise.rb          # èªè¨¼è¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ openai.rb          # OpenAIè¨­å®š
â”‚   â”‚   â”œâ”€â”€ routes.rb          # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ database.yml       # DBè¨­å®š
â”‚   â”‚   â””â”€â”€ credentials.yml.enc # ç§˜åŒ¿æƒ…å ±
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ migrate/           # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â”œâ”€â”€ 001_devise_create_users.rb
â”‚   â”‚   â”‚   â”œâ”€â”€ 002_create_anger_logs.rb
â”‚   â”‚   â”‚   â”œâ”€â”€ 003_create_trigger_words.rb
â”‚   â”‚   â”‚   â””â”€â”€ 004_create_ai_advices.rb
â”‚   â”‚   â””â”€â”€ seeds.rb
â”‚   â”‚
â”‚   â”œâ”€â”€ spec/                  # RSpecãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ models/            # ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ requests/          # APIãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ services/          # ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â””â”€â”€ factories/         # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”‚   â”‚
â”‚   â”œâ”€â”€ .rubocop.yml           # RuboCopè¨­å®š
â”‚   â””â”€â”€ Gemfile                # ä¾å­˜é–¢ä¿‚
â”‚
â”œâ”€â”€ .gitignore                 # çµ±åˆç‰ˆgitignore
â””â”€â”€ README.md                  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ï¼ˆç°¡æ½”ç‰ˆï¼‰
```

## ğŸ—ƒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ERDï¼ˆEntity Relationship Diagramï¼‰

```
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚                Users                â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â”‚ id (PK)                             â”‚
                            â”‚ email (UNIQUE)                      â”‚
                            â”‚ encrypted_password                  â”‚
                            â”‚ name                                â”‚
                            â”‚ reset_password_token                â”‚
                            â”‚ reset_password_sent_at              â”‚
                            â”‚ remember_created_at                 â”‚
                            â”‚ created_at, updated_at              â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        AngerLogs            â”‚ â”‚ CalmingPoints   â”‚ â”‚      TriggerWords       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ id (PK)                     â”‚ â”‚ id (PK)         â”‚ â”‚ id (PK)                 â”‚
    â”‚ user_id (FK) â†’ users.id     â”‚ â”‚ user_id (FK)    â”‚ â”‚ user_id (FK) â†’ users.id â”‚
    â”‚ anger_level (1-10)          â”‚ â”‚ total_points    â”‚ â”‚ name                    â”‚
    â”‚ occurred_at                 â”‚ â”‚ current_level   â”‚ â”‚ count                   â”‚
    â”‚ location                    â”‚ â”‚ streak_days     â”‚ â”‚ anger_level_avg         â”‚
    â”‚ situation_description       â”‚ â”‚ last_action_dateâ”‚ â”‚ category                â”‚
    â”‚ trigger_words               â”‚ â”‚ level_achievementsâ”‚ â”‚ last_triggered_at      â”‚
    â”‚ emotions_felt (JSONB)       â”‚ â”‚ milestone_flags â”‚ â”‚ created_at, updated_at  â”‚
    â”‚ ai_advice                   â”‚ â”‚ created_at      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ reflection                  â”‚ â”‚ updated_at      â”‚              â”‚
    â”‚ created_at, updated_at      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    ContactMessages      â”‚
                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â”‚ id (PK)                 â”‚
                         â”‚ user_id (FK, NULLå¯)    â”‚
                         â”‚ email                   â”‚
                         â”‚ name                    â”‚
                         â”‚ category                â”‚
                         â”‚ subject                 â”‚
                         â”‚ message                 â”‚
                         â”‚ status                  â”‚
                         â”‚ admin_reply             â”‚
                         â”‚ replied_at              â”‚
                         â”‚ created_at, updated_at  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MVPä»¥é™æ‹¡å¼µãƒ†ãƒ¼ãƒ–ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â–¼                          â–¼                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Badges      â”‚    â”‚   UserBadges    â”‚    â”‚    WiseSayings      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚â—„â”€â”€â”€â”¤ badge_id (FK)   â”‚    â”‚ id (PK)             â”‚
â”‚ name (UNIQUE)   â”‚    â”‚ id (PK)         â”‚    â”‚ content             â”‚
â”‚ description     â”‚    â”‚ user_id (FK)    â”‚â—„â”€â” â”‚ author              â”‚
â”‚ icon_url        â”‚    â”‚ earned_at       â”‚  â”‚ â”‚ category            â”‚
â”‚ badge_type      â”‚    â”‚ created_at      â”‚  â”‚ â”‚ anger_level_range   â”‚
â”‚ requirements    â”‚    â”‚ updated_at      â”‚  â”‚ â”‚ is_active           â”‚
â”‚ points_reward   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ display_count       â”‚
â”‚ is_active       â”‚                         â”‚ â”‚ created_at          â”‚
â”‚ created_at      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ updated_at          â”‚
â”‚ updated_at      â”‚    â”‚    Reminders    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
                       â”‚ id (PK)         â”‚  â”‚
                       â”‚ user_id (FK)    â”‚â—„â”€â”˜
                       â”‚ reminder_type   â”‚
                       â”‚ title           â”‚
                       â”‚ message         â”‚
                       â”‚ schedule_time   â”‚
                       â”‚ days_of_week    â”‚
                       â”‚ is_active       â”‚
                       â”‚ last_sent_at    â”‚
                       â”‚ created_at      â”‚
                       â”‚ updated_at      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°

#### MVPå¿…é ˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ5ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

##### Users ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE users (
  id BIGINT PRIMARY KEY,
  email VARCHAR NOT NULL UNIQUE,
  encrypted_password VARCHAR NOT NULL,
  name VARCHAR NOT NULL,
  reset_password_token VARCHAR,
  reset_password_sent_at TIMESTAMP,
  remember_created_at TIMESTAMP,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE UNIQUE INDEX index_users_on_email ON users(email);
```

##### AngerLogs ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE anger_logs (
  id BIGINT PRIMARY KEY,
  user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  -- åŸºæœ¬æ€’ã‚Šæƒ…å ±
  anger_level INTEGER NOT NULL CHECK (anger_level BETWEEN 1 AND 10),
  occurred_at TIMESTAMP NOT NULL,
  location VARCHAR,
  -- çŠ¶æ³ãƒ»åŸå› 
  situation_description TEXT NOT NULL,
  trigger_words VARCHAR,
  emotions_felt JSONB,
  -- AIã‚¢ãƒ‰ãƒã‚¤ã‚¹
  ai_advice TEXT,
  -- æŒ¯ã‚Šè¿”ã‚Š
  reflection TEXT,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_anger_logs_on_user_id ON anger_logs(user_id);
CREATE INDEX index_anger_logs_on_occurred_at ON anger_logs(occurred_at);
CREATE INDEX index_anger_logs_on_user_id_and_occurred_at ON anger_logs(user_id, occurred_at);
CREATE INDEX index_anger_logs_on_anger_level ON anger_logs(anger_level);
CREATE INDEX index_anger_logs_on_emotions_felt ON anger_logs USING GIN(emotions_felt);
```

##### CalmingPoints ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE calming_points (
  id BIGINT PRIMARY KEY,
  user_id BIGINT NOT NULL UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  total_points INTEGER DEFAULT 0,
  current_level INTEGER DEFAULT 1,
  streak_days INTEGER DEFAULT 0,
  last_action_date DATE,
  level_achievements JSONB,
  milestone_flags JSONB,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL,
  CHECK (total_points >= 0 AND current_level >= 1 AND streak_days >= 0)
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE UNIQUE INDEX index_calming_points_on_user_id ON calming_points(user_id);
CREATE INDEX index_calming_points_on_current_level ON calming_points(current_level);
```

##### TriggerWords ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼‰
```sql
CREATE TABLE trigger_words (
  id BIGINT PRIMARY KEY,
  user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  name VARCHAR NOT NULL,
  count INTEGER DEFAULT 1,
  anger_level_avg FLOAT,
  category VARCHAR,
  last_triggered_at TIMESTAMP,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_trigger_words_on_user_id_and_count ON trigger_words(user_id, count);
CREATE UNIQUE INDEX index_trigger_words_on_user_id_and_name ON trigger_words(user_id, name);
CREATE INDEX index_trigger_words_on_category ON trigger_words(category);
```

##### ContactMessages ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE contact_messages (
  id BIGINT PRIMARY KEY,
  user_id BIGINT REFERENCES users(id) ON DELETE SET NULL,
  email VARCHAR NOT NULL,
  name VARCHAR NOT NULL,
  category VARCHAR,
  subject VARCHAR NOT NULL,
  message TEXT NOT NULL,
  status VARCHAR DEFAULT 'open' CHECK (status IN ('open', 'in_progress', 'closed')),
  admin_reply TEXT,
  replied_at TIMESTAMP,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_contact_messages_on_user_id ON contact_messages(user_id);
CREATE INDEX index_contact_messages_on_status ON contact_messages(status);
CREATE INDEX index_contact_messages_on_category ON contact_messages(category);
```

#### MVPä»¥é™æ‹¡å¼µãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ4ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

##### Badges ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE badges (
  id BIGINT PRIMARY KEY,
  name VARCHAR NOT NULL UNIQUE,
  description TEXT NOT NULL,
  icon_url VARCHAR,
  badge_type VARCHAR,
  requirements JSONB,
  points_reward INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE UNIQUE INDEX index_badges_on_name ON badges(name);
CREATE INDEX index_badges_on_badge_type ON badges(badge_type);
CREATE INDEX index_badges_on_is_active ON badges(is_active);
```

##### UserBadges ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE user_badges (
  id BIGINT PRIMARY KEY,
  user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  badge_id BIGINT NOT NULL REFERENCES badges(id) ON DELETE CASCADE,
  earned_at TIMESTAMP NOT NULL,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_user_badges_on_user_id ON user_badges(user_id);
CREATE INDEX index_user_badges_on_badge_id ON user_badges(badge_id);
CREATE UNIQUE INDEX index_user_badges_on_user_id_and_badge_id ON user_badges(user_id, badge_id);
CREATE INDEX index_user_badges_on_earned_at ON user_badges(earned_at);
```

##### WiseSayings ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE wise_sayings (
  id BIGINT PRIMARY KEY,
  content TEXT NOT NULL,
  author VARCHAR,
  category VARCHAR,
  anger_level_range VARCHAR,
  is_active BOOLEAN DEFAULT true,
  display_count INTEGER DEFAULT 0,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_wise_sayings_on_category ON wise_sayings(category);
CREATE INDEX index_wise_sayings_on_anger_level_range ON wise_sayings(anger_level_range);
CREATE INDEX index_wise_sayings_on_is_active ON wise_sayings(is_active);
```

##### Reminders ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE reminders (
  id BIGINT PRIMARY KEY,
  user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  reminder_type VARCHAR,
  title VARCHAR NOT NULL,
  message TEXT,
  schedule_time TIME,
  days_of_week JSONB,
  is_active BOOLEAN DEFAULT true,
  last_sent_at TIMESTAMP,
  created_at TIMESTAMP NOT NULL,
  updated_at TIMESTAMP NOT NULL
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX index_reminders_on_user_id ON reminders(user_id);
CREATE INDEX index_reminders_on_reminder_type ON reminders(reminder_type);
CREATE INDEX index_reminders_on_is_active ON reminders(is_active);
CREATE INDEX index_reminders_on_schedule_time ON reminders(schedule_time);
```

## ğŸ”Œ APIè¨­è¨ˆ

### RESTful API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### èªè¨¼API
```
POST   /api/v1/auth/register     # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
POST   /api/v1/auth/login        # ãƒ­ã‚°ã‚¤ãƒ³
DELETE /api/v1/auth/logout       # ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
GET    /api/v1/auth/me           # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
```

#### ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°API
```
GET    /api/v1/anger_logs        # ãƒ­ã‚°ä¸€è¦§å–å¾—
POST   /api/v1/anger_logs        # ãƒ­ã‚°ä½œæˆ
GET    /api/v1/anger_logs/:id    # ãƒ­ã‚°è©³ç´°å–å¾—
PUT    /api/v1/anger_logs/:id    # ãƒ­ã‚°æ›´æ–°
DELETE /api/v1/anger_logs/:id    # ãƒ­ã‚°å‰Šé™¤
```

#### åˆ†æAPI
```
GET    /api/v1/analytics/trends        # å‚¾å‘åˆ†æãƒ‡ãƒ¼ã‚¿
GET    /api/v1/analytics/bubble_map    # ãƒãƒ–ãƒ«ãƒãƒƒãƒ—ç”¨ãƒ‡ãƒ¼ã‚¿
GET    /api/v1/analytics/calendar      # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”¨ãƒ‡ãƒ¼ã‚¿
GET    /api/v1/analytics/summary       # ã‚µãƒãƒªãƒ¼çµ±è¨ˆ
```

#### AIç›¸è«‡API
```
POST   /api/v1/consultations           # AIç›¸è«‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
GET    /api/v1/consultations           # ç›¸è«‡å±¥æ­´å–å¾—
GET    /api/v1/consultations/:id       # ç›¸è«‡è©³ç´°å–å¾—
```

### API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹

#### ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°ä½œæˆ
```http
POST /api/v1/anger_logs
Content-Type: application/json
Authorization: Bearer <JWT_TOKEN>

{
  "anger_log": {
    "anger_level": 7,
    "trigger_event": "ä¼šè­°ã§ã®æ‰¹åˆ¤çš„ãªã‚³ãƒ¡ãƒ³ãƒˆ",
    "coping_method": "æ·±å‘¼å¸ã‚’10å›",
    "notes": "åŒåƒšã®ç™ºè¨€ã«ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸ",
    "occurred_at": "2025-07-26T14:30:00Z",
    "trigger_words": ["æ‰¹åˆ¤", "å¦å®š", "ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼"]
  }
}

# Response
{
  "id": 123,
  "anger_level": 7,
  "trigger_event": "ä¼šè­°ã§ã®æ‰¹åˆ¤çš„ãªã‚³ãƒ¡ãƒ³ãƒˆ",
  "coping_method": "æ·±å‘¼å¸ã‚’10å›",
  "notes": "åŒåƒšã®ç™ºè¨€ã«ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸ",
  "occurred_at": "2025-07-26T14:30:00Z",
  "trigger_words": [
    {"word": "æ‰¹åˆ¤", "intensity": 4},
    {"word": "å¦å®š", "intensity": 3},
    {"word": "ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼", "intensity": 5}
  ],
  "created_at": "2025-07-26T14:35:00Z",
  "updated_at": "2025-07-26T14:35:00Z"
}
```

#### åˆ†æãƒ‡ãƒ¼ã‚¿å–å¾—
```http
GET /api/v1/analytics/bubble_map?period=30days
Authorization: Bearer <JWT_TOKEN>

# Response
{
  "data": [
    {
      "trigger_word": "æ‰¹åˆ¤",
      "frequency": 15,
      "avg_anger_level": 6.2,
      "effectiveness_score": 3.8,
      "size": 25,
      "color": "#ff6b6b"
    },
    {
      "trigger_word": "ç· åˆ‡",
      "frequency": 8,
      "avg_anger_level": 7.1,
      "effectiveness_score": 4.2,
      "size": 18,
      "color": "#4ecdc4"
    }
  ],
  "meta": {
    "period": "30days",
    "total_logs": 45,
    "avg_anger_level": 5.8
  }
}
```

## ğŸ¨ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆæ€æƒ³

#### Atomic Design æ¡ç”¨
```
Atoms (åŸå­)
â”œâ”€â”€ Button/          # åŸºæœ¬ãƒœã‚¿ãƒ³
â”œâ”€â”€ Input/           # å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
â”œâ”€â”€ Icon/            # ã‚¢ã‚¤ã‚³ãƒ³
â””â”€â”€ Label/           # ãƒ©ãƒ™ãƒ«

Molecules (åˆ†å­)
â”œâ”€â”€ FormField/       # ãƒ©ãƒ™ãƒ« + å…¥åŠ› + ã‚¨ãƒ©ãƒ¼
â”œâ”€â”€ SearchBox/       # æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹
â””â”€â”€ AngerLevelSlider/ # æ€’ã‚Šãƒ¬ãƒ™ãƒ«ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼

Organisms (æœ‰æ©Ÿä½“)
â”œâ”€â”€ Header/          # ãƒ˜ãƒƒãƒ€ãƒ¼
â”œâ”€â”€ AngerLogForm/    # ãƒ­ã‚°ä½œæˆãƒ•ã‚©ãƒ¼ãƒ 
â”œâ”€â”€ BubbleMap/       # D3.js ãƒãƒ–ãƒ«ãƒãƒƒãƒ—
â””â”€â”€ AIConsultation/  # AIç›¸è«‡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

Templates (ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ)
â”œâ”€â”€ AuthLayout/      # èªè¨¼ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ DashboardLayout/ # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â””â”€â”€ AnalysisLayout/  # åˆ†æç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

Pages (ãƒšãƒ¼ã‚¸)
â”œâ”€â”€ LoginPage/       # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”œâ”€â”€ DashboardPage/   # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”œâ”€â”€ RecordsPage/     # è¨˜éŒ²ä¸€è¦§
â””â”€â”€ AnalysisPage/    # åˆ†æç”»é¢
```

### çŠ¶æ…‹ç®¡ç†è¨­è¨ˆï¼ˆZustandï¼‰

#### Store æ§‹æˆ
```typescript
// authStore.ts - èªè¨¼çŠ¶æ…‹
interface AuthState {
  user: User | null
  isAuthenticated: boolean
  login: (credentials: LoginCredentials) => Promise<void>
  logout: () => void
  refreshToken: () => Promise<void>
}

// angerLogStore.ts - ã‚¢ãƒ³ã‚¬ãƒ¼ãƒ­ã‚°çŠ¶æ…‹
interface AngerLogState {
  logs: AngerLog[]
  currentLog: AngerLog | null
  loading: boolean
  fetchLogs: () => Promise<void>
  createLog: (log: CreateAngerLogRequest) => Promise<void>
  updateLog: (id: number, log: UpdateAngerLogRequest) => Promise<void>
  deleteLog: (id: number) => Promise<void>
}

// uiStore.ts - UIçŠ¶æ…‹
interface UIState {
  sidebarOpen: boolean
  theme: 'light' | 'dark'
  notifications: Notification[]
  loading: boolean
  toggleSidebar: () => void
  setTheme: (theme: 'light' | 'dark') => void
  addNotification: (notification: Notification) => void
}
```

### ã‚´ãƒªãƒ©ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ 

#### ãƒ†ãƒ¼ãƒæ§‹æˆ
```typescript
// theme/gorilla.ts
export const gorillaTheme = createTheme({
  palette: {
    primary: {
      main: '#8B4513',      // ã‚µãƒ‰ãƒ«ãƒ–ãƒ©ã‚¦ãƒ³ï¼ˆã‚´ãƒªãƒ©ï¼‰
      light: '#A0522D',     // ã‚·ã‚¨ãƒ³ãƒŠ
      dark: '#654321',      // ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ©ã‚¦ãƒ³
    },
    secondary: {
      main: '#FFD700',      // ã‚´ãƒ¼ãƒ«ãƒ‰ï¼ˆãƒãƒŠãƒŠï¼‰
      light: '#FFFF99',     // ãƒ©ã‚¤ãƒˆã‚¤ã‚¨ãƒ­ãƒ¼
      dark: '#FFB347',      // ãƒ”ãƒ¼ãƒ
    },
    // æ€’ã‚Šãƒ¬ãƒ™ãƒ«åˆ¥ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
    anger: {
      1: '#E8F5E8',         // æ¥µè–„ç·‘ï¼ˆè½ã¡ç€ãï¼‰
      2: '#C8E6C9',         # è–„ç·‘
      3: '#A5D6A7',         # ç·‘
      4: '#81C784',         # æ˜ç·‘
      5: '#FFD54F',         # é»„è‰²ï¼ˆæ³¨æ„ï¼‰
      6: '#FFB74D',         # ã‚ªãƒ¬ãƒ³ã‚¸
      7: '#FF8A65',         # æ¿ƒã‚ªãƒ¬ãƒ³ã‚¸
      8: '#FF7043',         # èµ¤ã‚ªãƒ¬ãƒ³ã‚¸
      9: '#F44336',         # èµ¤ï¼ˆè­¦å‘Šï¼‰
      10: '#C62828',        # æ¿ƒèµ¤ï¼ˆå±é™ºï¼‰
    }
  },
  components: {
    MuiButton: {
      styleOverrides: {
        root: {
          borderRadius: 12,
          textTransform: 'none',
          fontWeight: 600,
          background: 'linear-gradient(45deg, #8B4513 30%, #A0522D 90%)',
        }
      }
    }
  }
})
```

## ğŸ§© ä¸»è¦æ©Ÿèƒ½ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 1. èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

#### JWT ãƒ•ãƒ­ãƒ¼
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³
   â†“
2. Rails: JWTç”Ÿæˆï¼ˆuser.jtiå«ã‚€ï¼‰
   â†“
3. Next.js: JWTã‚’ã‚¯ãƒƒã‚­ãƒ¼ã«ä¿å­˜
   â†“
4. API ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: Authorization Headerã« JWT
   â†“
5. Rails: JWTæ¤œè¨¼ + user.jtiç¢ºèª
```

#### Session Management
```typescript
// lib/auth/session.ts
export async function createSession(token: string) {
  const encryptedSession = await encrypt({ token })
  cookies().set('session', encryptedSession, {
    httpOnly: true,
    secure: true,
    sameSite: 'strict',
    maxAge: 60 * 60 * 24 * 7, // 1 week
  })
}
```

### 2. ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ï¼ˆD3.jsï¼‰

#### ãƒãƒ–ãƒ«ãƒãƒƒãƒ—å®Ÿè£…
```typescript
// features/visualization/d3-utils/bubbleChart.ts
export class BubbleChartRenderer {
  private svg: d3.Selection<SVGSVGElement, unknown, null, undefined>
  private simulation: d3.Simulation<BubbleNode, undefined>

  constructor(container: HTMLElement, data: BubbleData[]) {
    this.svg = d3.select(container).append('svg')
    this.simulation = d3.forceSimulation<BubbleNode>()
      .force('center', d3.forceCenter(width / 2, height / 2))
      .force('collision', d3.forceCollide().radius(d => d.radius + 2))
  }

  render(data: BubbleData[]) {
    const nodes = this.processData(data)
    this.updateSimulation(nodes)
    this.renderBubbles(nodes)
  }
}
```

### 3. AIç›¸è«‡æ©Ÿèƒ½

#### OpenAIçµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```ruby
# app/services/openai_service.rb
class OpenAIService
  def generate_advice(anger_log, user_context)
    prompt = build_prompt(anger_log, user_context)
    
    response = client.chat(
      parameters: {
        model: "gpt-4o-mini",
        messages: [
          { role: "system", content: system_prompt },
          { role: "user", content: prompt }
        ],
        max_tokens: 500,
        temperature: 0.7
      }
    )
    
    parse_response(response)
  end

  private

  def build_prompt(anger_log, user_context)
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éå»ã®å‚¾å‘ã€ç¾åœ¨ã®çŠ¶æ³ã‚’è€ƒæ…®ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
  end
end
```

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æœ€é©åŒ–

#### Next.js æœ€é©åŒ–
```typescript
// next.config.js
const nextConfig = {
  experimental: {
    turbo: true,        // Turbopackä½¿ç”¨
    optimizeCss: true,  # CSSæœ€é©åŒ–
  },
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
  images: {
    formats: ['image/webp', 'image/avif'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
  }
}
```

#### Code Splitting
```typescript
// Dynamic imports for heavy components
const BubbleMap = dynamic(() => import('@/features/visualization/BubbleMap'), {
  loading: () => <LoadingSpinner />,
  ssr: false
})

const AIConsultation = dynamic(() => import('@/features/consultation/AIConsultation'), {
  loading: () => <LoadingSpinner />
})
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æœ€é©åŒ–

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–
```ruby
# app/models/anger_log.rb
class AngerLog < ApplicationRecord
  # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š
  # INDEX: user_id, occurred_at (è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹)
  # INDEX: anger_level (åˆ†æã‚¯ã‚¨ãƒªç”¨)
  
  scope :for_analysis, ->(period) {
    includes(:trigger_words, :ai_advices)
      .where(occurred_at: period)
      .order(:occurred_at)
  }
  
  # N+1å•é¡Œå›é¿
  scope :with_associations, -> { includes(:trigger_words, :ai_advices) }
end
```

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
```ruby
# app/controllers/api/v1/analytics_controller.rb
class Api::V1::AnalyticsController < ApplicationController
  def bubble_map
    cache_key = "analytics:bubble_map:#{current_user.id}:#{params[:period]}"
    
    data = Rails.cache.fetch(cache_key, expires_in: 1.hour) do
      AngerAnalysisService.new(current_user).bubble_map_data(params[:period])
    end
    
    render json: data
  end
end
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### èªè¨¼ãƒ»èªå¯
```ruby
# app/controllers/application_controller.rb
class ApplicationController < ActionController::API
  before_action :authenticate_user!
  before_action :configure_permitted_parameters, if: :devise_controller?

  private

  def authenticate_user!
    token = request.headers['Authorization']&.split(' ')&.last
    return render_unauthorized unless token

    payload = JWT.decode(token, Rails.application.credentials.devise_jwt_secret_key!).first
    user = User.find_by(id: payload['sub'], jti: payload['jti'])
    
    return render_unauthorized unless user
    
    @current_user = user
  rescue JWT::DecodeError, JWT::ExpiredSignature
    render_unauthorized
  end
end
```

### CORSè¨­å®š
```ruby
# config/initializers/cors.rb
Rails.application.config.middleware.insert_before 0, Rack::Cors do
  allow do
    origins ['localhost:3000', 'https://angori.vercel.app']
    resource '/api/*',
      headers: :any,
      methods: [:get, :post, :put, :patch, :delete, :options, :head],
      credentials: true
  end
end
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
```typescript
// __tests__/features/auth/LoginForm.test.tsx
describe('LoginForm', () => {
  it('should submit form with valid credentials', async () => {
    const mockLogin = jest.fn()
    render(<LoginForm onLogin={mockLogin} />)
    
    await user.type(screen.getByLabelText(/email/i), 'test@example.com')
    await user.type(screen.getByLabelText(/password/i), 'password123')
    await user.click(screen.getByRole('button', { name: /login/i }))
    
    expect(mockLogin).toHaveBeenCalledWith({
      email: 'test@example.com',
      password: 'password123'
    })
  })
})
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
```ruby
# spec/requests/api/v1/anger_logs_spec.rb
RSpec.describe 'API::V1::AngerLogs', type: :request do
  let(:user) { create(:user) }
  let(:headers) { { 'Authorization' => "Bearer #{jwt_token_for(user)}" } }

  describe 'POST /api/v1/anger_logs' do
    let(:params) do
      {
        anger_log: {
          anger_level: 7,
          trigger_event: 'Meeting stress',
          coping_method: 'Deep breathing'
        }
      }
    end

    it 'creates anger log successfully' do
      post '/api/v1/anger_logs', params: params, headers: headers
      
      expect(response).to have_http_status(:created)
      expect(json['anger_level']).to eq(7)
      expect(AngerLog.count).to eq(1)
    end
  end
end
```

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚Šã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã§ä¿å®ˆæ€§ã®é«˜ã„ã‚¢ãƒ³ã‚¬ãƒ¼ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿç¾ã—ã¾ã™ã€‚